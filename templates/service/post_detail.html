{% extends '../base.html' %}
{% load static %}

{% block content %}

<main id="main">

  <!-- ======= Breadcrumbs ======= -->
  <section class="breadcrumbs">
    <div class="container">

      <ol>
        <li><a href="/">Home</a></li>
        <li><a href="{% url 'all_posts' %}">Blog</a></li>
        <li>Blog Single</li>
      </ol>
      <h2>{{ post.title }}</h2>

    </div>
  </section><!-- End Breadcrumbs -->

  <!-- ======= Blog Single Section ======= -->
  <section id="blog" class="blog">
    <div class="container" data-aos="fade-up">

      <div class="row">

        <div class="col-lg-8 entries">

          <article class="entry entry-single">

            <div class="entry-img">
              <div class="portfolio-details-slider swiper">
                <div class="swiper-wrapper align-items-center">

                  <div class="swiper-slide">
                    <img style="width: 98%; height: auto;" src="{{ post.image.url }}" alt="">
                  </div>

                  <div class="swiper-slide">
                    <img style="width: 98%; height: auto;" src="{{ post.image2.url }}" alt="">
                  </div>

                  <div class="swiper-slide">
                    <img style="width: 98%; height: auto;" src="{{ post.image3.url }}" alt="">
                  </div>


                </div>
                <div class="swiper-pagination"></div>
              </div>
            </div>

            <h2 class="entry-title">
              <a href="">{{ post.title }}</a>
            </h2>

            <div class="entry-meta">
              <ul>
                <li class="d-flex align-items-center"><i class="bi bi-person"></i> <a href="">{{ post.author }}</a></li>
                <li class="d-flex align-items-center"><i class="bi bi-clock"></i> <a href=""><time
                      datetime="2020-01-01">{{ post.created_at }}</time></a></li>
                <li class="d-flex align-items-center"><i class="bi bi-chat-dots"></i> <a href="">{{ cout_reviews }} Comentarios</a></li>
                <li class="d-flex align-items-center"><i class=""></i>
                  <h4>|</h1>
                  </h4>
                  {% if request.user == post.author %}
                    <li style="justify-content: space-between" class="d-flex align-items-center"><i class="bi bi-pen"></i>
                      <a href="{% url 'edit_post' post.id %}">Edit</a></li>
                    <li style="justify-content: space-between" class="d-flex align-items-center"><i class="bi bi-trash"></i>
                      <a href="{% url 'delete' post.id %}">Delete</a></li>
                {% endif %}
              </ul>
            </div>

            <div class="entry-content">
              <div class="blog-author d-flex align-items-center">
                <div>
                  <h5>Conclucion</h5>
                  <p style="color: rgb(106, 106, 106);">
                    {{ post.content }}
                  </p>
                </div>
              </div><!-- End blog author bio -->
              <p>{{ post.detailed_description|safe }}</p>

            </div>

            <div class="entry-footer">
              <i class="bi bi-folder"></i>
              <ul class="cats">
                <li><a href="{% url 'category_list' post.id %}">{{ post.category }}</a></li>
              </ul>
            </div>

          </article><!-- End blog entry -->



          <div class="blog-comments">
            
            <h4 class="comments-count">{{ cout_reviews }} Comentarios</h4>
            <form method="POST">
              {% csrf_token %}
              {{ form.rating }}
              {{ form.text }}
              <button type="submit" class="btn btn-primary">Submit</button>
            </form>
            <div id="comment-1" class="comment">
              {% for review in reviews %}
              <div class="d-flex">
                <div class="comment-img"><img src="{{ review.user.profile.user_image.url }}" alt=""></div>
                <div>
                  <h5><a href="">{{ review.user }}</a> <a href="#" class="reply"><i class="bi bi-reply-[fill]"></i> Responder</a>
                  </h5>
                  <time datetime="2020-01-01">{{ review.created_at }}</time>
                  <p>
                    {{ review.text }}
                  </p>
                </div>
                  <p>valoraci√≥n: {{ review.rating }}/5</p>
              </div>
              {% endfor %}

            </div><!-- End comment #1 -->

          </div><!-- End blog comments -->
        </div><!-- End blog entries list -->


        <div class="col-lg-4">
          <div class="sidebar">
            <div class="sidebar-item search-form">
              <div class="portfolio-info">
                <h3>Project information</h3>
                <ul>
                  <li><strong>Category</strong>: {{ post.category }}</li>
                  <li><strong>Subido</strong>: {{ post.created_at }}</li>
                  <li><strong>Actualisado</strong>: {{ post.updated }}</li>
                  <li><strong>Precio</strong>: ${{ post.get_display_price }}</li>
                </ul>
              </div>
            </div><!-- End sidebar search formn-->
            <div class="card">
              <div class="card-body">
                <center><h4 style="color: green;">${{ post.get_display_price }}</h4></center>
                  <!-- updated form action with product ID/pk as a URL parameter -->
                  <form action="{% url 'create_checkout_session' post.pk %}" method="POST">
                    {% csrf_token %}
                    <button class="btn btn-primary form-control" type="submit" id="checkout-button">Checkout</button>
                  </form>
              </div>
            </div>
          </div><!-- End sidebar recent posts-->

        </div><!-- End sidebar -->

      </div><!-- End blog sidebar -->
    </div>
    </div>
  </section><!-- End Blog Single Section -->
</main><!-- End #main -->
{% endblock %}